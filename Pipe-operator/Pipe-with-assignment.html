<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <title>Pipe with assignment | pipeR Tutorial</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.0.3">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    
    <link rel="next" href="../Pipe-operator/Extract-element.html" />
    
    
    <link rel="prev" href="../Pipe-operator/Pipe-for-side-effect.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book"  data-level="2.5" data-basepath=".." data-revision="1410967664741">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="Getting-started/README.html">
            
                
                    <a href="../Getting-started/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         Getting started
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.1" data-path="Getting-started/First-example.html">
            
                
                    <a href="../Getting-started/First-example.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         First example
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="Getting-started/Design-principles.html">
            
                
                    <a href="../Getting-started/Design-principles.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                         Design principles
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="Pipe-operator/README.html">
            
                
                    <a href="../Pipe-operator/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         Pipe operator
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1" data-path="Pipe-operator/Pipe-to-first-argument.html">
            
                
                    <a href="../Pipe-operator/Pipe-to-first-argument.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                         Pipe to first-argument
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2" data-path="Pipe-operator/Pipe-to-dot.html">
            
                
                    <a href="../Pipe-operator/Pipe-to-dot.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                         Pipe to dot
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.3" data-path="Pipe-operator/Pipe-by-formula.html">
            
                
                    <a href="../Pipe-operator/Pipe-by-formula.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                         Pipe by formula
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4" data-path="Pipe-operator/Pipe-for-side-effect.html">
            
                
                    <a href="../Pipe-operator/Pipe-for-side-effect.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                         Pipe for side effect
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter active" data-level="2.5" data-path="Pipe-operator/Pipe-with-assignment.html">
            
                
                    <a href="../Pipe-operator/Pipe-with-assignment.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                         Pipe with assignment
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.6" data-path="Pipe-operator/Extract-element.html">
            
                
                    <a href="../Pipe-operator/Extract-element.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                         Extract element
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="Pipe-function/README.html">
            
                
                    <a href="../Pipe-function/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         Pipe function
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.1" data-path="Pipe-function/Pipe-to-first-argument.html">
            
                
                    <a href="../Pipe-function/Pipe-to-first-argument.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                         Pipe to first-argument
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.2" data-path="Pipe-function/Dot-function.html">
            
                
                    <a href="../Pipe-function/Dot-function.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                         Dot function
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3" data-path="Pipe-function/Subsetting.html">
            
                
                    <a href="../Pipe-function/Subsetting.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                         Subsetting
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4" data-path="Examples/README.html">
            
                
                    <a href="../Examples/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         Examples
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.1" data-path="Examples/dplyr.html">
            
                
                    <a href="../Examples/dplyr.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                         dplyr
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.2" data-path="Examples/ggvis.html">
            
                
                    <a href="../Examples/ggvis.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                         ggvis
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.3" data-path="Examples/rlist.html">
            
                
                    <a href="../Examples/rlist.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                         rlist
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.4" data-path="Examples/rvest.html">
            
                
                    <a href="../Examples/rvest.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                         rvest
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >pipeR Tutorial</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_18">
                    
                        <h1 id="pipe-with-assignment">Pipe with assignment</h1>
<p>Previously, we covered side effect piping, that is, if an enclosed expression that follows <code>%&gt;&gt;%</code> starts with <code>~</code>, it tells the operator to evaluate the expression only for its side effect.</p>
<p>Functions having side effects can be categorized into several types. We have shown side effects such as printing (<code>print()</code> objects), message (<code>cat()</code>, <code>message()</code>), and graphics (<code>plot()</code>).</p>
<p>In addition to printing and plotting, one may need to save an intermediate value to the environment by assigning it to a variable (or symbol). Perhaps assignment is the most important side effect among all. Just imagine a version of R in which we cannot assign.</p>
<p>Therefore, assignment as a side effect deserves a set of syntax to be made easier. If one needs to assign the value to a symbol, just insert a step like <code>(~ symbol)</code>, then the input value of that step will be assigned to <code>symbol</code> in the current environment. </p>
<p>This syntax is probably the simplest case for an side effect. Since evaluating a symbol for side effect rarely makes sense, it is instead interpreted as assigning input value to the given symbol.</p>
<pre><code class="lang-r">mtcars %&gt;&gt;%
  subset(select = c(mpg, wt, cyl)) %&gt;&gt;%
  (~ sub_mtcars) %&gt;&gt;% <span class="hljs-comment"># assign subsetted mtcars to sub_mtcars</span>
  lm(formula = mpg ~ wt + cyl) %&gt;&gt;%
  (~ lm_mtcars) %&gt;&gt;%  <span class="hljs-comment"># assign linear model to lm_mtcars</span>
  summary
</code></pre>
<pre><code># 
# Call:
# lm(formula = mpg ~ wt + cyl, data = .)
# 
# Residuals:
#     Min      1Q  Median      3Q     Max 
# -4.2893 -1.5512 -0.4684  1.5743  6.1004 
# 
# Coefficients:
#             Estimate Std. Error t value Pr(&gt;|t|)    
# (Intercept)  39.6863     1.7150  23.141  &lt; 2e-16 ***
# wt           -3.1910     0.7569  -4.216 0.000222 ***
# cyl          -1.5078     0.4147  -3.636 0.001064 ** 
# ---
# Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
# 
# Residual standard error: 2.568 on 29 degrees of freedom
# Multiple R-squared:  0.8302,    Adjusted R-squared:  0.8185 
# F-statistic: 70.91 on 2 and 29 DF,  p-value: 6.809e-12
</code></pre><p>Then we can inspect the environment and see what is in it.</p>
<pre><code class="lang-r">ls.str()
</code></pre>
<pre><code># lm_mtcars : List of 12
#  $ coefficients : Named num [1:3] 39.69 -3.19 -1.51
#  $ residuals    : Named num [1:32] -1.279 -0.465 -3.452 1.019 2.053 ...
#  $ effects      : Named num [1:32] -113.65 -29.12 -9.34 1.33 1.6 ...
#  $ rank         : int 3
#  $ fitted.values: Named num [1:32] 22.3 21.5 26.3 20.4 16.6 ...
#  $ assign       : int [1:3] 0 1 2
#  $ qr           :List of 5
#  $ df.residual  : int 29
#  $ xlevels      : Named list()
#  $ call         : language lm(formula = mpg ~ wt + cyl, data = .)
#  $ terms        :Classes &#39;terms&#39;, &#39;formula&#39; length 3 mpg ~ wt + cyl
#  $ model        :&#39;data.frame&#39;:    32 obs. of  3 variables:
# sub_mtcars : &#39;data.frame&#39;:    32 obs. of  3 variables:
#  $ mpg: num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
#  $ wt : num  2.62 2.88 2.32 3.21 3.44 ...
#  $ cyl: num  6 6 4 6 8 6 8 4 4 6 ...
</code></pre><p>These two variables are exactly the intermediate results we wanted to save to the environment.</p>
<p>However, sometimes we don&#39;t want to directly save the input value but the value after some transformation. Then we can use <code>=</code> to specify a lambda expression to tell what to be saved. In pipeR v0.5, <code>&lt;-</code> and more natural <code>-&gt;</code> are allowed in assignment too, which may make the code more readable.</p>
<pre><code class="lang-r">mtcars %&gt;&gt;%
  subset(select = c(mpg, wt, cyl)) %&gt;&gt;%
  (~ summ = summary(.)) %&gt;&gt;%  <span class="hljs-comment"># side-effect assignment</span>
  lm(formula = mpg ~ wt + cyl)
</code></pre>
<pre><code># 
# Call:
# lm(formula = mpg ~ wt + cyl, data = .)
# 
# Coefficients:
# (Intercept)           wt          cyl  
#      39.686       -3.191       -1.508
</code></pre><p>Then we can notice that <code>summ</code> is saved to the environment.</p>
<pre><code class="lang-r">summ
</code></pre>
<pre><code>#       mpg              wt             cyl       
#  Min.   :10.40   Min.   :1.513   Min.   :4.000  
#  1st Qu.:15.43   1st Qu.:2.581   1st Qu.:4.000  
#  Median :19.20   Median :3.325   Median :6.000  
#  Mean   :20.09   Mean   :3.217   Mean   :6.188  
#  3rd Qu.:22.80   3rd Qu.:3.610   3rd Qu.:8.000  
#  Max.   :33.90   Max.   :5.424   Max.   :8.000
</code></pre><p>Like side effect expression can be a lambda expression, so can the expression being assigned following <code>=</code>.</p>
<pre><code class="lang-r">mtcars %&gt;&gt;%
  subset(select = c(mpg, wt, cyl)) %&gt;&gt;%
  (~ summ = df ~ summary(df)) %&gt;&gt;%  <span class="hljs-comment"># side-effect assignment</span>
  lm(formula = mpg ~ wt + cyl)
</code></pre>
<p>Note that the all above assignment operations works purely as side effect, they do not influence the value being piped. In other words, if these lines are removed, the input value will continue piping but without being assigned to given symbol.</p>
<p>What if one really wants the result not only to be assigned to a symbol but also to continue the flow to the next expression?</p>
<p>Two methods meet the demand:</p>
<ol>
<li>Use <code>(~ symbol)</code> after the expression for assignment.</li>
<li>Use <code>(symbol = expression)</code> to assign the value of <code>expression</code> to <code>symbol</code>.</li>
</ol>
<p>Note that the second method is fresh here but it should look natural because it can be easily distinguished from <code>(~ symbol = expression)</code> which is only for side effect.</p>
<pre><code class="lang-r">mtcars %&gt;&gt;%
  subset(select = c(mpg, wt, cyl)) %&gt;&gt;%
  (~ summ = df ~ summary(df)) %&gt;&gt;%  <span class="hljs-comment"># side-effect assignment</span>
  (model = lm(mpg ~ wt + cyl, data = .)) <span class="hljs-comment"># pipe and assign</span>
</code></pre>
<p>To verify the assignment, evaluate <code>model</code>.</p>
<pre><code class="lang-r">model
</code></pre>
<pre><code># 
# Call:
# lm(formula = mpg ~ wt + cyl, data = .)
# 
# Coefficients:
# (Intercept)           wt          cyl  
#      39.686       -3.191       -1.508
</code></pre><p>In pipeR v0.5, the assignment operators are enabled for their job. Note that the merit of a pipeline is its readability, a contributing factor is that the functions in each step are immediately visible so that one can easily figure out what the code does. The <code>=</code> syntax for assignment, to some extent, weakens the readability of the code because the functions are put behind, which, by contrast, does not happen with <code>-&gt;</code> used for assignment.</p>
<pre><code class="lang-r">mtcars %&gt;&gt;%
  (~ summary(.) -&gt; summ)

mtcars %&gt;&gt;%
  (~ summ &lt;- summary(.))
</code></pre>
<p>The <code>(~ expression -&gt; symbol)</code> and <code>(~ symbol &lt;- expression)</code> syntax work for side-effect assignment, and <code>(expression -&gt; symbol)</code> and <code>(symbol &lt;- assignment)</code> work for piping with assignment.</p>
<pre><code class="lang-r">mtcars %&gt;&gt;%
  (~ summary(.) -&gt; summ) %&gt;&gt;%  <span class="hljs-comment"># side-effect assignment</span>
  (lm(formula = mpg ~ wt + cyl, data = .) -&gt; lm_mtcars) %&gt;&gt;%  <span class="hljs-comment"># continue piping</span>
  summary
</code></pre>
<p>In addition to all above examples, the assignment feature is more powerful than has been demonstrated. The assignment operators <code>=</code>, <code>&lt;-</code> and <code>-&gt;</code> even support subset and element assignment. For example,</p>
<pre><code class="lang-r">results &lt;- list()
mtcars %&gt;&gt;%
  lm(formula = mpg ~ wt + cyl) %&gt;&gt;%
  (~ results$mtcars = . %&gt;&gt;% summary %&gt;&gt;% (r.squared))
</code></pre>
<pre><code># 
# Call:
# lm(formula = mpg ~ wt + cyl, data = .)
# 
# Coefficients:
# (Intercept)           wt          cyl  
#      39.686       -3.191       -1.508
</code></pre><pre><code class="lang-r">iris %&gt;&gt;%
  lm(formula = Sepal.Length ~ Sepal.Width) %&gt;&gt;%
  (~ results$iris = . %&gt;&gt;% summary %&gt;&gt;% (r.squared))
</code></pre>
<pre><code># 
# Call:
# lm(formula = Sepal.Length ~ Sepal.Width, data = .)
# 
# Coefficients:
# (Intercept)  Sepal.Width  
#      6.5262      -0.2234
</code></pre><p>Then we can print the results and see the values in it.</p>
<pre><code class="lang-r">results
</code></pre>
<pre><code># $mtcars
# [1] 0.8302274
# 
# $iris
# [1] 0.01382265
</code></pre><p>The similar code works with <code>-&gt;</code> or <code>&lt;-</code> too, which can be more natural and less disturbing in pipeline.</p>
<pre><code class="lang-r">set.seed(<span class="hljs-number">0</span>)
results &lt;- numeric()
rnorm(<span class="hljs-number">100</span>) %&gt;&gt;%
  (~ mean(.) -&gt; results[<span class="hljs-string">"mean"</span>]) %&gt;&gt;%
  (~ median(.) -&gt; results[<span class="hljs-string">"median"</span>]) %&gt;&gt;%
  summary
</code></pre>
<pre><code>#     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
# -2.22400 -0.56940 -0.03296  0.02267  0.62540  2.44100
</code></pre><p>Print <code>results</code> and show the values in it.</p>
<pre><code class="lang-r">results
</code></pre>
<pre><code>#        mean      median 
#  0.02266845 -0.03296148
</code></pre><p>More than simply assigning values to symbols, the expression can also be setting names and others.</p>
<pre><code class="lang-r">numbers &lt;- <span class="hljs-number">1</span>:<span class="hljs-number">5</span>
letters %&gt;&gt;%
  sample(length(numbers)) %&gt;&gt;%
  (~ . -&gt; names(numbers))
</code></pre>
<pre><code># [1] &quot;u&quot; &quot;g&quot; &quot;f&quot; &quot;l&quot; &quot;x&quot;
</code></pre><p>Now the names of <code>numbers</code> become the randomly sampled letters.</p>
<pre><code class="lang-r">numbers
</code></pre>
<pre><code># u g f l x 
# 1 2 3 4 5
</code></pre>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../Pipe-operator/Pipe-for-side-effect.html" class="navigation navigation-prev " aria-label="Previous page: Pipe for side effect"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../Pipe-operator/Extract-element.html" class="navigation navigation-next " aria-label="Next page: Extract element"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

    
    <script src="https://cdn.mathjax.org/mathjax/2.4-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"ga":{"token":"UA-47159422-1","configuration":"auto"},"disqus":{"shortName":"renkun-ken"}};
    gitbook.start(config);
});
</script>

        <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-47159422-1', 'auto');ga('send', 'pageview');</script>
    </body>
    
</html>
